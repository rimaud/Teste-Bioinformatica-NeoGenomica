## problema de usar o database hg19 do SnpEff, confirma neste Link https://github.com/pcingola/SnpEff/issues/604
## Portanto, iremos construir o nosso banco de dados 
## RODAR O SCRIPT annotation.sh antes de usar o snakemake, assim teremos o database h19_custom para fazer a anotação
## vale salientar que usei o arquivo BRCA.bed, uma vez que --target só espera arquivo de formato .bed

1 - Quantas sequências de DNA de paciente sequenciados temos nos arquivos de fastqs R1 e R2 respectivamente ?
file                                format  type  num_seqs
510-7-BRCA_S8_L001_R1_001.fastq.gz  FASTQ   DNA     64,276       
510-7-BRCA_S8_L001_R2_001.fastq.gz  FASTQ   DNA     64,276  

2 - Sobre o genoma humano hg19, quantos contigs tem o nosso genoma hg19 (hg19.fasta) aqui disponibilizado para este pipeline ?
file        format  type  num_seqs        
hg19.fasta  FASTA   DNA         93 

3 - Quantos alinhamentos há na região chr17:41197694-41197819 ? 
samtools view -c output/bwa/marked/510-7-BRCA_S8_L001.bam chr17:41197694-41197819
Resulatdo: 1662 

4 - Quantos alinhamentos não conseguiram ser mapeados (unmapped alignments ?) 
samtools view -c -f 0x4 -F 0x900 output/bwa/marked/510-7-BRCA_S8_L001.bam
Resulatdo: 0 
Não há reads não mapeadas no BAM final, uma vez que apliquei filtro de qualidade no samtools no rules/alignment.smk --> Portanto todos os reads restnates foram mapeados com confiança ao genoma de refeencia h19.


5 - Realize o alinhamento das sequências FASTQ contra o genoma de referência hg19 aqui disponibilizado, e realize a chamada de variantes utilizando a região alvo BRCA.list (interesse apenas na região dos genes BRCA1 e BRCA2).  Realize a anotação de dados funcionais usando o SNPEFF.
 Com este arquivo em mãos , responda as seguintes perguntas ?

5.1- Quantas variantes existem com impacto funcional (Annotation_Impact) do tipo HIGH, MODERATE, LOW ? Existe alguma variante em HIGH ? Qual é cromossomo, posição e a alteração ?

HIGH: 1 variante (deleção frameshift) com 12 efeitos.
MODERATE: 2 variante (SNP do tipo missense) com 5 efeitos.
LOW: 4 variantes (SNPs do tipo synonymous) com 8 efeitos.

Existe 1 variante HIGH : Deleção (frameshift)  de 19 nucleotídeos no Gene BRCA1
Variant: chr17:41222948 TTCTTCTGGGGTCAGGCCAG > T
Genótipo: heterozigoto (0/1) {GT:DP:AD:RO:QR:AO:QA:GL	0/1:606:401,193:401:15180:193:7145:-463.828,0,-1186.42}

